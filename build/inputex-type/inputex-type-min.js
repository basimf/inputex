YUI.add("inputex-type",function(e,t){var n=e.Lang,r=e.inputEx;r.TypeField=function(e){r.TypeField.superclass.constructor.call(this,e)},e.extend(r.TypeField,r.Field,{renderComponent:function(){this.fieldValueWrapper=r.cn("div",{className:"inputEx-TypeField-FieldValueWrapper"}),this.fieldContainer.appendChild(this.fieldValueWrapper),this.propertyPanel=r.cn("div",{className:"inputEx-TypeField-PropertiesPanel"},{display:"none"});var e=[];for(var t in r.typeClasses)r.typeClasses.hasOwnProperty(t)&&e.push({value:t});this.typeSelect=new r.SelectField({label:"Type",choices:e,parentEl:this.propertyPanel}),this.groupOptionsWrapper=r.cn("div"),this.propertyPanel.appendChild(this.groupOptionsWrapper),this.button=r.cn("div",{className:"inputEx-TypeField-EditButton"}),this.button.appendChild(this.propertyPanel),this.fieldContainer.appendChild(this.button),this.rebuildGroupOptions()},initEvents:function(){r.TypeField.superclass.initEvents.call(this),e.one(this.button).on("click",this.onTogglePropertiesPanel,this,!0),e.one(this.propertyPanel).on("click",function(e){e.stopPropagation()},this,!0),this.typeSelect.on("updated",this.rebuildGroupOptions,this,!0)},rebuildGroupOptions:function(){try{var t=null;this.group&&(t=this.group.getValue(),this.group.close(),this.group.destroy(),this.groupOptionsWrapper.innerHTML="");var n=r.getFieldClass(this.typeSelect.getValue()),i={fields:n.groupOptions,parentEl:this.groupOptionsWrapper};this.group=new r.Group(i),t&&this.group.setValue({name:t.name,label:t.label}),this.group.on("updated",this.onChangeGroupOptions,this,!0),this.updateFieldValue()}catch(s){e.Lang.isObject(window.console)&&e.Lang.isFunction(window.console.log)&&console.log("inputEx.TypeField.rebuildGroupOptions: ",s)}},onTogglePropertiesPanel:function(){this.propertyPanel.style.display=="none"?(this.propertyPanel.style.display="",e.one(this.button).addClass(this.button,"opened")):(this.propertyPanel.style.display="none",e.one(this.button).removeClass("opened"))},onChangeGroupOptions:function(){this.updateFieldValue(),this.fireUpdatedEvt()},updateFieldValue:function(){try{this.fieldValue&&(this.fieldValue.close(),this.fieldValue.destroy(),delete this.fieldValue,this.fieldValueWrapper.innerHTML="");var t=this.group.getValue();t.type=this.getValue().type,t.parentEl=this.fieldValueWrapper,this.fieldValue=r(t,this),this.fieldValue.on("updated",this.fireUpdatedEvt,this,!0)}catch(n){e.Lang.isObject(window.console)&&e.Lang.isFunction(window.console.log)&&console.log("Error while updateFieldValue",n.message)}},setValue:function(e,t){this.typeSelect.setValue(e.type,!1),this.rebuildGroupOptions(),this.group.setValue(e,!1),this.updateFieldValue();var r=this;n.isUndefined(e.value)||setTimeout(function(){r.fieldValue.setValue(e.value,!1)},50),t!==!1&&this.fireUpdatedEvt(!1)},getValue:function(){var e=function(e,t){var n,r=e.groupOptions.length,i;for(n=0;n<r;n++){i=e.groupOptions[n];if(i.name==t)return i.value}return undefined},t=this.group.getValue(),n=r.getFieldClass(this.typeSelect.getValue());for(var i in t)if(t.hasOwnProperty(i)){var s=e(n,i),o=t[i];s==o&&(t[i]=undefined)}return t.type=this.typeSelect.getValue(),this.fieldValue&&(t.value=this.fieldValue.getValue()),t}}),r.registerType("type",r.TypeField,[])},"@VERSION@",{requires:["inputex-field","inputex-group","inputex-select","inputex-list","inputex-string","inputex-checkbox","inputex-integer"],skinnable:!0,ix_provides:"type"});

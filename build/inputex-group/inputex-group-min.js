YUI.add("inputex-group",function(e,t){var n=e.Lang,r=e.inputEx;r.Group=function(e){r.Group.superclass.constructor.call(this,e),this.options.value||this.runFieldsInteractions()},e.extend(r.Group,r.Field,{setOptions:function(e){r.Group.superclass.setOptions.call(this,e),this.options.className=e.className||"inputEx-Group",this.options.fields=e.fields,this.options.flatten=e.flatten,this.options.legend=e.legend||"",this.options.collapsible=n.isUndefined(e.collapsible)?!1:e.collapsible,this.options.collapsed=n.isUndefined(e.collapsed)?!1:e.collapsed,this.inputs=[],this.inputsLength=0,this.inputsNames={}},render:function(){this.divEl=r.cn("div",{className:this.options.className}),this.options.id&&(this.divEl.id=this.options.id),this.renderFields(this.divEl),this.options.disabled&&this.disable()},renderFields:function(e){var t,i,s;this.fieldset=r.cn("fieldset"),this.legend=r.cn("legend",{className:"inputEx-Group-legend"}),this.options.collapsible&&(t=r.cn("div",{className:"inputEx-Group-collapseImg"},null," "),this.legend.appendChild(t),r.sn(this.fieldset,{className:"inputEx-Expanded"})),!n.isUndefined(this.options.legend)&&this.options.legend!==""&&this.legend.appendChild(r.cn("span",null,null," "+this.options.legend)),(this.options.collapsible||!n.isUndefined(this.options.legend)&&this.options.legend!=="")&&this.fieldset.appendChild(this.legend);if(!this.options.fields)throw new Error("Missing 'fields' property in options");for(i=0;i<this.options.fields.length;i++){s=this.options.fields[i];if(!s)throw new Error("inputEx.Form: One of the provided fields is undefined ! (check trailing comma)");this.addField(s)}this.options.collapsed&&this.toggleCollapse(),e.appendChild(this.fieldset)},addField:function(e){var t=this.renderField(e);this.fieldset.appendChild(t.getEl())},renderField:function(t){var i=r(t,this);return this.inputs.push(i),this.inputsLength+=1,i.options.name&&(this.inputsNames[i.options.name]=i),i.options.flatten&&n.isObject(i.inputsNames)&&(e.mix(this.inputsNames,i.inputsNames),this.inputs=this.inputs.concat(i.inputs),this.inputsLength+=i.inputs.length),!this.hasInteractions&&t.interactions&&(this.hasInteractions=!0),i.on("updated",this.onChange,this),i},initEvents:function(){this.options.collapsible&&e.on("click",this.toggleCollapse,this.legend,this)},toggleCollapse:function(){e.one(this.fieldset).hasClass("inputEx-Expanded")?e.one(this.fieldset).replaceClass("inputEx-Expanded","inputEx-Collapsed"):e.one(this.fieldset).replaceClass("inputEx-Collapsed","inputEx-Expanded")},validate:function(){var e,t,n,i=!0;for(e=0;e<this.inputsLength;e++){t=this.inputs[e];if(!t.isDisabled()){n=t.getState(),t.setClassFromState(n);if(n===r.stateRequired||n===r.stateInvalid)i=!1}}return i},getFieldsStates:function(){var e,t,n,i,s,o={fields:{},validate:!0};for(s=0;s<this.inputsLength;s++){e=this.inputs[s],t=e.options.name,n=e.getState(),i=e.getStateString(n),o.fields[t]={},o.fields[t].valid=!0,o.fields[t].message=i;if(n===r.stateRequired||n===r.stateInvalid)o.fields[t].valid=!1,o.validate=!1}return o},enable:function(){for(var e=0;e<this.inputsLength;e++)this.inputs[e].enable();return r.Group.superclass.enable.call(this)},disable:function(){for(var e=0;e<this.inputsLength;e++)this.inputs[e].disable();return r.Group.superclass.disable.call(this)},setValue:function(e,t){var r,i,s;if(!e)return;for(r=0;r<this.inputsLength;r++)i=this.inputs[r],s=i.options.name,s&&!n.isUndefined(e[s])?i.setValue(e[s],!1):i.clear(!1);this.runFieldsInteractions(),t!==!1&&this.fireUpdatedEvt()},getValue:function(){var t,r,i={};for(t=0;t<this.inputsLength;t++)r=this.inputs[t].getValue(),this.inputs[t].options.name&&(this.inputs[t].options.flatten&&n.isObject(r)?e.mix(i,r):i[this.inputs[t].options.name]=r);return i},isEmpty:function(){var e,t=!0;for(e=0;e<this.inputsLength;e++)t=t&&this.inputs[e].isEmpty();return t},close:function(){for(var e=0;e<this.inputsLength;e++)this.inputs[e].close()},focus:function(){this.inputsLength>0&&this.inputs[0].focus()},getFieldByName:function(e){return this.inputsNames.hasOwnProperty(e)?this.inputsNames[e]:null},findFieldByName:function(e,t){var r,i,s,o,u=this,a=this.inputs;if(t){if(this.inputsNames.hasOwnProperty(e)&&(o=this.inputsNames[e]))for(i=0;i<this.inputsLength;++i){r=a[i];if(n.isFunction(r.getFieldByName)&&(o=r.getFieldByName(e,!0)))break}return o}while((s=u.getParentField())&&n.isFunction(s.getFieldByName))u=s;return u.getFieldByName(e,!0)},onChange:function(e,t){this.runInteractions(t,e),this.fireUpdatedEvt()},runAction:function(e,t){var r=this.getFieldByName(e.name);if(n.isFunction(r[e.action]))r[e.action].call(r);else{if(!n.isFunction(e.action))throw new Error("action "+e.action+" is not a valid action for field "+e.name);e.action.call(r,t)}},runInteractions:function(e,t){var i,s,o,u,a,f,l=r.indexOf(e,this.inputs),c=this.options.fields[l];if(n.isUndefined(c)||n.isUndefined(c.interactions))return;i=c.interactions;for(o=0,u=i.length;o<u;o++){s=i[o];if(s.valueTrigger===t)for(a=0,f=s.actions.length;a<f;a++)this.runAction(s.actions[a],t)}},runFieldsInteractions:function(){if(this.hasInteractions)for(var e=0;e<this.inputsLength;e++)this.runInteractions(this.inputs[e],this.inputs[e].getValue())},clear:function(e){for(var t=0;t<this.inputsLength;t++)this.inputs[t].clear(!1);e!==!1&&this.fireUpdatedEvt()},setErrors:function(t){var r,i,s;if(n.isArray(t))for(r=0;r<t.length;r++)i=t[r][0],s=t[r][1],this.inputsNames[i]&&this.inputsNames[i].options.showMsg&&(this.inputsNames[i].displayMessage(s),e.one(this.inputsNames[i].divEl).replaceClass("inputEx-valid","inputEx-invalid"));else if(n.isObject(t))for(i in t)t.hasOwnProperty(i)&&this.inputsNames[i]&&this.inputsNames[i].options.showMsg&&(this.inputsNames[i].displayMessage(t[i]),e.one(this.inputsNames[i].divEl).replaceClass("inputEx-valid","inputEx-invalid"))},setFieldName:function(e){var t,n=this.inputsLength;for(t=0;t<n;t++)this.inputs[t].setFieldName(e+""+(this.inputs[t].el&&this.inputs[t].el.name||"group-"+t))},destroy:function(){var e,t,n;for(e=0,
t=this.inputsLength;e<t;e++)n=this.inputs[e],n.destroy();r.Group.superclass.destroy.call(this)}}),r.registerType("group",r.Group,[{type:"string",label:"Name",name:"name",value:""},{type:"string",label:"Legend",name:"legend"},{type:"boolean",label:"Collapsible",name:"collapsible",value:!1},{type:"boolean",label:"Collapsed",name:"collapsed",value:!1},{type:"list",label:"Fields",name:"fields",elementType:{type:"type"}}],!0)},"@VERSION@",{requires:["inputex-field"],ix_provides:"group",skinnable:!0});

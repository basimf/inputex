<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/jsonschema/js/jsonschema.js - InputEx</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="InputEx" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 4.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/inputEx.html">inputEx</a></li>
                                <li><a href="../classes/inputEx.AutoComplete.html">inputEx.AutoComplete</a></li>
                                <li><a href="../classes/inputEx.Base.html">inputEx.Base</a></li>
                                <li><a href="../classes/inputEx.CheckBox.html">inputEx.CheckBox</a></li>
                                <li><a href="../classes/inputEx.CheckboxMultiState.html">inputEx.CheckboxMultiState</a></li>
                                <li><a href="../classes/inputEx.ColorField.html">inputEx.ColorField</a></li>
                                <li><a href="../classes/inputEx.CombineField.html">inputEx.CombineField</a></li>
                                <li><a href="../classes/inputEx.constructor.html">inputEx.constructor</a></li>
                                <li><a href="../classes/inputEx.DateField.html">inputEx.DateField</a></li>
                                <li><a href="../classes/inputEx.DatePickerField.html">inputEx.DatePickerField</a></li>
                                <li><a href="../classes/inputEx.DateSelectMonthField.html">inputEx.DateSelectMonthField</a></li>
                                <li><a href="../classes/inputEx.DateSplitField.html">inputEx.DateSplitField</a></li>
                                <li><a href="../classes/inputEx.DateTimeField.html">inputEx.DateTimeField</a></li>
                                <li><a href="../classes/inputEx.DDListField.html">inputEx.DDListField</a></li>
                                <li><a href="../classes/inputEx.DomainNameField.html">inputEx.DomainNameField</a></li>
                                <li><a href="../classes/inputEx.DSSelectField.html">inputEx.DSSelectField</a></li>
                                <li><a href="../classes/inputEx.EmailField.html">inputEx.EmailField</a></li>
                                <li><a href="../classes/inputEx.FileField.html">inputEx.FileField</a></li>
                                <li><a href="../classes/inputEx.Form.html">inputEx.Form</a></li>
                                <li><a href="../classes/inputEx.Group.html">inputEx.Group</a></li>
                                <li><a href="../classes/inputEx.HiddenField.html">inputEx.HiddenField</a></li>
                                <li><a href="../classes/inputEx.ImageCropperField.html">inputEx.ImageCropperField</a></li>
                                <li><a href="../classes/inputEx.InPlaceEdit.html">inputEx.InPlaceEdit</a></li>
                                <li><a href="../classes/inputEx.IntegerField.html">inputEx.IntegerField</a></li>
                                <li><a href="../classes/inputEx.IPv4Field.html">inputEx.IPv4Field</a></li>
                                <li><a href="../classes/inputEx.JsonSchema.html">inputEx.JsonSchema</a></li>
                                <li><a href="../classes/inputEx.JsonSchema.Builder.html">inputEx.JsonSchema.Builder</a></li>
                                <li><a href="../classes/inputEx.KeyOpValueField.html">inputEx.KeyOpValueField</a></li>
                                <li><a href="../classes/inputEx.KeyValueField.html">inputEx.KeyValueField</a></li>
                                <li><a href="../classes/inputEx.Lens.html">inputEx.Lens</a></li>
                                <li><a href="../classes/inputEx.LinkedComboField.html">inputEx.LinkedComboField</a></li>
                                <li><a href="../classes/inputEx.ListField.html">inputEx.ListField</a></li>
                                <li><a href="../classes/inputEx.MapField.html">inputEx.MapField</a></li>
                                <li><a href="../classes/inputEx.MenuField.html">inputEx.MenuField</a></li>
                                <li><a href="../classes/inputEx.mixin.html">inputEx.mixin</a></li>
                                <li><a href="../classes/inputEx.mixin.choice.html">inputEx.mixin.choice</a></li>
                                <li><a href="../classes/inputEx.MultiAutoComplete.html">inputEx.MultiAutoComplete</a></li>
                                <li><a href="../classes/inputEx.MultiSelectField.html">inputEx.MultiSelectField</a></li>
                                <li><a href="../classes/inputEx.NumberField.html">inputEx.NumberField</a></li>
                                <li><a href="../classes/inputEx.ObjectField.html">inputEx.ObjectField</a></li>
                                <li><a href="../classes/inputEx.Panel.html">inputEx.Panel</a></li>
                                <li><a href="../classes/inputEx.PasswordField.html">inputEx.PasswordField</a></li>
                                <li><a href="../classes/inputEx.PhoneField.html">inputEx.PhoneField</a></li>
                                <li><a href="../classes/inputEx.Plugin.InputExDataTable.html">inputEx.Plugin.InputExDataTable</a></li>
                                <li><a href="../classes/inputEx.RadioField.html">inputEx.RadioField</a></li>
                                <li><a href="../classes/inputEx.RatingStars.html">inputEx.RatingStars</a></li>
                                <li><a href="../classes/inputEx.RatingStarsForm.html">inputEx.RatingStarsForm</a></li>
                                <li><a href="../classes/inputEx.RPC.html">inputEx.RPC</a></li>
                                <li><a href="../classes/inputEx.RPC.Envelope.html">inputEx.RPC.Envelope</a></li>
                                <li><a href="../classes/inputEx.RPC.Envelope.JSON.html">inputEx.RPC.Envelope.JSON</a></li>
                                <li><a href="../classes/inputEx.RPC.Envelope.JSON-RPC-1.0.html">inputEx.RPC.Envelope.JSON-RPC-1.0</a></li>
                                <li><a href="../classes/inputEx.RPC.Envelope.JSON-RPC-2.0.html">inputEx.RPC.Envelope.JSON-RPC-2.0</a></li>
                                <li><a href="../classes/inputEx.RPC.Envelope.PATH.html">inputEx.RPC.Envelope.PATH</a></li>
                                <li><a href="../classes/inputEx.RPC.Envelope.URL.html">inputEx.RPC.Envelope.URL</a></li>
                                <li><a href="../classes/inputEx.RPC.Service.html">inputEx.RPC.Service</a></li>
                                <li><a href="../classes/inputEx.RPC.SMDTester.html">inputEx.RPC.SMDTester</a></li>
                                <li><a href="../classes/inputEx.RPC.Transport.html">inputEx.RPC.Transport</a></li>
                                <li><a href="../classes/inputEx.RTEField.html">inputEx.RTEField</a></li>
                                <li><a href="../classes/inputEx.SelectField.html">inputEx.SelectField</a></li>
                                <li><a href="../classes/inputEx.SerializeField.html">inputEx.SerializeField</a></li>
                                <li><a href="../classes/inputEx.SerializeField.serializers.html">inputEx.SerializeField.serializers</a></li>
                                <li><a href="../classes/inputEx.SerializeField.serializers.json.html">inputEx.SerializeField.serializers.json</a></li>
                                <li><a href="../classes/inputEx.SerializeField.serializers.xml.html">inputEx.SerializeField.serializers.xml</a></li>
                                <li><a href="../classes/inputEx.SliderField.html">inputEx.SliderField</a></li>
                                <li><a href="../classes/inputEx.StringAvailability.html">inputEx.StringAvailability</a></li>
                                <li><a href="../classes/inputEx.StringField.html">inputEx.StringField</a></li>
                                <li><a href="../classes/inputEx.Textarea.html">inputEx.Textarea</a></li>
                                <li><a href="../classes/inputEx.TextAutoTag.html">inputEx.TextAutoTag</a></li>
                                <li><a href="../classes/inputEx.TimeField.html">inputEx.TimeField</a></li>
                                <li><a href="../classes/inputEx.TimeIntervalField.html">inputEx.TimeIntervalField</a></li>
                                <li><a href="../classes/inputEx.TinyMCEField.html">inputEx.TinyMCEField</a></li>
                                <li><a href="../classes/inputEx.TreeField.html">inputEx.TreeField</a></li>
                                <li><a href="../classes/inputEx.TypeField.html">inputEx.TypeField</a></li>
                                <li><a href="../classes/inputEx.UneditableField.html">inputEx.UneditableField</a></li>
                                <li><a href="../classes/inputEx.UpperCaseField.html">inputEx.UpperCaseField</a></li>
                                <li><a href="../classes/inputEx.UrlField.html">inputEx.UrlField</a></li>
                                <li><a href="../classes/inputEx.VectorField.html">inputEx.VectorField</a></li>
                                <li><a href="../classes/inputEx.visus.html">inputEx.visus</a></li>
                                <li><a href="../classes/inputEx.widget.html">inputEx.widget</a></li>
                                <li><a href="../classes/inputEx.widget.Button.html">inputEx.widget.Button</a></li>
                                <li><a href="../classes/inputEx.widget.JsonTreeInspector.html">inputEx.widget.JsonTreeInspector</a></li>
                                <li><a href="../classes/Plugin.CalendarTodayHighlight.html">Plugin.CalendarTodayHighlight</a></li>
                                <li><a href="../classes/Plugin.CalendarWeekNumber.html">Plugin.CalendarWeekNumber</a></li>
                                <li><a href="../classes/Plugin.NodeMenuNavImproved.html">Plugin.NodeMenuNavImproved</a></li>
                                <li><a href="../classes/Y.InputexAccentRemover.html">Y.InputexAccentRemover</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/checkbox-multi-state.html">checkbox-multi-state</a></li>
                                <li><a href="../modules/inputex.html">inputex</a></li>
                                <li><a href="../modules/inputex-accent-remover
                
                As you may guess, this module will help you on the way you will handle your accent.
                There is a by instance configuration and you can easilly change it. see the example below
                
                ex:
                
                 var myAccentRemover1 = new Y.inputEx.AccentRemover(); __ check the default configuration for &#x27;e&#x27; below
                 var myAccentRemover2 = new Y.inputEx.AccentRemover();
                 myAccentRemover2.conf.e.regexp = _[èêẽēĕėëẻěȅȇẹȩęḙḛềếễểḕḗệḝǝɛ]_gi; __ we remove the é in the regexp
                
                 myAccentRemover1.removeAccents(&quot;treétreè&quot;); __ treetree
                 myAccentRemover2.removeAccents(&quot;treétreè&quot;); __ treétree.html">inputex-accent-remover
                
                As you may guess, this module will help you on the way you will handle your accent.
                There is a by instance configuration and you can easilly change it. see the example below
                
                ex:
                
                 var myAccentRemover1 = new Y.inputEx.AccentRemover(); // check the default configuration for &#x27;e&#x27; below
                 var myAccentRemover2 = new Y.inputEx.AccentRemover();
                 myAccentRemover2.conf.e.regexp = /[èêẽēĕėëẻěȅȇẹȩęḙḛềếễểḕḗệḝǝɛ]/gi; // we remove the é in the regexp
                
                 myAccentRemover1.removeAccents(&quot;treétreè&quot;); // treetree
                 myAccentRemover2.removeAccents(&quot;treétreè&quot;); // treétree</a></li>
                                <li><a href="../modules/inputex-autocomplete.html">inputex-autocomplete</a></li>
                                <li><a href="../modules/inputex-base.html">inputex-base</a></li>
                                <li><a href="../modules/inputex-button.html">inputex-button</a></li>
                                <li><a href="../modules/inputex-checkbox.html">inputex-checkbox</a></li>
                                <li><a href="../modules/inputex-choice.html">inputex-choice</a></li>
                                <li><a href="../modules/inputex-color.html">inputex-color</a></li>
                                <li><a href="../modules/inputex-combine.html">inputex-combine</a></li>
                                <li><a href="../modules/inputex-datatable.html">inputex-datatable</a></li>
                                <li><a href="../modules/inputex-date.html">inputex-date</a></li>
                                <li><a href="../modules/inputex-datepicker.html">inputex-datepicker</a></li>
                                <li><a href="../modules/inputex-dateselectmonth.html">inputex-dateselectmonth</a></li>
                                <li><a href="../modules/inputex-datesplit.html">inputex-datesplit</a></li>
                                <li><a href="../modules/inputex-datetime.html">inputex-datetime</a></li>
                                <li><a href="../modules/inputex-ddlist.html">inputex-ddlist</a></li>
                                <li><a href="../modules/inputex-dsselect.html">inputex-dsselect</a></li>
                                <li><a href="../modules/inputex-email.html">inputex-email</a></li>
                                <li><a href="../modules/inputex-field.html">inputex-field</a></li>
                                <li><a href="../modules/inputex-file.html">inputex-file</a></li>
                                <li><a href="../modules/inputex-form.html">inputex-form</a></li>
                                <li><a href="../modules/inputex-group.html">inputex-group</a></li>
                                <li><a href="../modules/inputex-hidden.html">inputex-hidden</a></li>
                                <li><a href="../modules/inputex-imagecropper.html">inputex-imagecropper</a></li>
                                <li><a href="../modules/inputex-inplaceedit.html">inputex-inplaceedit</a></li>
                                <li><a href="../modules/inputex-integer.html">inputex-integer</a></li>
                                <li><a href="../modules/inputex-ipv4.html">inputex-ipv4</a></li>
                                <li><a href="../modules/inputex-jsonschema.html">inputex-jsonschema</a></li>
                                <li><a href="../modules/inputex-jsontreeinspector.html">inputex-jsontreeinspector</a></li>
                                <li><a href="../modules/inputex-keyopvalue.html">inputex-keyopvalue</a></li>
                                <li><a href="../modules/inputex-keyvalue.html">inputex-keyvalue</a></li>
                                <li><a href="../modules/inputex-lens.html">inputex-lens</a></li>
                                <li><a href="../modules/inputex-linkedcombo.html">inputex-linkedcombo</a></li>
                                <li><a href="../modules/inputex-list.html">inputex-list</a></li>
                                <li><a href="../modules/inputex-map.html">inputex-map</a></li>
                                <li><a href="../modules/inputex-menu.html">inputex-menu</a></li>
                                <li><a href="../modules/inputex-multiautocomplete.html">inputex-multiautocomplete</a></li>
                                <li><a href="../modules/inputex-multiselect.html">inputex-multiselect</a></li>
                                <li><a href="../modules/inputex-number.html">inputex-number</a></li>
                                <li><a href="../modules/inputex-object.html">inputex-object</a></li>
                                <li><a href="../modules/inputex-panel.html">inputex-panel</a></li>
                                <li><a href="../modules/inputex-password.html">inputex-password</a></li>
                                <li><a href="../modules/inputex-phone.html">inputex-phone</a></li>
                                <li><a href="../modules/inputex-radio.html">inputex-radio</a></li>
                                <li><a href="../modules/inputex-ratingstars.html">inputex-ratingstars</a></li>
                                <li><a href="../modules/inputex-ratingstarsform.html">inputex-ratingstarsform</a></li>
                                <li><a href="../modules/inputex-rpc.html">inputex-rpc</a></li>
                                <li><a href="../modules/inputex-rte.html">inputex-rte</a></li>
                                <li><a href="../modules/inputex-select.html">inputex-select</a></li>
                                <li><a href="../modules/inputex-serialize.html">inputex-serialize</a></li>
                                <li><a href="../modules/inputex-slider.html">inputex-slider</a></li>
                                <li><a href="../modules/inputex-smdtester.html">inputex-smdtester</a></li>
                                <li><a href="../modules/inputex-string.html">inputex-string</a></li>
                                <li><a href="../modules/inputex-stringavailability.html">inputex-stringavailability</a></li>
                                <li><a href="../modules/inputex-textarea.html">inputex-textarea</a></li>
                                <li><a href="../modules/inputex-textautotag.html">inputex-textautotag</a></li>
                                <li><a href="../modules/inputex-time.html">inputex-time</a></li>
                                <li><a href="../modules/inputex-timeinterval.html">inputex-timeinterval</a></li>
                                <li><a href="../modules/inputex-timerange.html">inputex-timerange</a></li>
                                <li><a href="../modules/inputex-tinymce.html">inputex-tinymce</a></li>
                                <li><a href="../modules/inputex-tree.html">inputex-tree</a></li>
                                <li><a href="../modules/inputex-type.html">inputex-type</a></li>
                                <li><a href="../modules/inputex-uneditable.html">inputex-uneditable</a></li>
                                <li><a href="../modules/inputex-uppercase.html">inputex-uppercase</a></li>
                                <li><a href="../modules/inputex-url.html">inputex-url</a></li>
                                <li><a href="../modules/inputex-vector.html">inputex-vector</a></li>
                                <li><a href="../modules/inputex-visus.html">inputex-visus</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/jsonschema/js/jsonschema.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * @module inputex-jsonschema
 */
var lang = Y.Lang,
    inputEx = Y.inputEx;
 
/**
 * Namespace containing utility functions for conversion between inputEx JSON format and JSON Schema
 *
 * based on &quot;Json Schema Proposal Working Draft&quot;:
 * http://groups.google.com/group/json-schema/web/json-schema-proposal-working-draft
 * The proposal is still under discussion and the implementation is very minimalist.
 *
 *
 * TODO:
 *    - we should provide a lot of json schema examples and instances that should/should not validate
 *    - use the $ref (async calls =&gt; provide callbacks to methods)
 *    - Inheritance
 *
 * Limitations:
 *    - ??? Please do not trust inputEx: the getValue may return a value which do NOT validate the schema (provide an example ?)
 *    - no tuple typing for arrays
 *    - no &quot;Union type definition&quot;
 *
 * @class inputEx.JsonSchema
 * @static
 */
inputEx.JsonSchema = {
   
   /**
    * Convert the inputEx JSON fields to a JSON schema
    * @method inputExToSchema
    * @static
    */
   inputExToSchema: function(inputExJson) {
      
      var t = inputExJson.type || &quot;string&quot;,
          ip = inputExJson || {};
      
      if(t == &quot;group&quot;) {
         var ret = {
            type:&#x27;object&#x27;,
            title: ip.legend,
            properties:{
            }
         };
         
         for(var i = 0 ; i &lt; ip.fields.length ; i++) {
            var field = ip.fields[i];
            
            var fieldName = field.name;
            ret.properties[fieldName] = inputEx.JsonSchema.inputExToSchema(field);
         }
         
         return ret;
      }
      else if(t == &quot;number&quot;) {
         return {
            &#x27;type&#x27;:&#x27;number&#x27;,
            &#x27;optional&#x27;: typeof ip.required == &quot;undefined&quot; ? true : !ip.required,
            &#x27;title&#x27;: ip.label
         };
      }
      else if(t == &quot;string&quot;) {
         return {
            &#x27;type&#x27;:&#x27;string&#x27;,
            &#x27;optional&#x27;: typeof ip.required == &quot;undefined&quot; ? true : !ip.required,
            &#x27;title&#x27;: ip.label
         };
      }
      else if(t == &quot;text&quot;) {
         return {
            &#x27;type&#x27;:&#x27;string&#x27;,
            &#x27;format&#x27;:&#x27;text&#x27;,
            &#x27;optional&#x27;: typeof ip.required == &quot;undefined&quot; ? true : !ip.required,
            &#x27;title&#x27;: ip.label,
            &#x27;_inputex&#x27;: {
               &#x27;rows&#x27;:5,
               &#x27;cols&#x27;:50
            }
         };
      }
      else if(t == &quot;html&quot;) {
         return {
            &#x27;type&#x27;:&#x27;string&#x27;,
            &#x27;format&#x27;:&#x27;html&#x27;,
            &#x27;optional&#x27;: typeof ip.required == &quot;undefined&quot; ? true : !ip.required,
            &#x27;title&#x27;: ip.label,
            &#x27;_inputex&#x27;: {}
         };
      }
      else if(t == &quot;list&quot;) {
         return {
            &#x27;type&#x27;:&#x27;array&#x27;,
            &#x27;title&#x27;: ip.label,
            &#x27;items&#x27;: inputEx.JsonSchema.inputExToSchema(ip.elementType),
            &#x27;_inputex&#x27;: {}
         };
      }
      else if(t == &quot;email&quot;) {
         return {
            &#x27;type&#x27;:&#x27;string&#x27;,
            &#x27;optional&#x27;: typeof ip.required == &quot;undefined&quot; ? true : !ip.required,
            &#x27;title&#x27;: ip.label,
            &#x27;format&#x27;:&#x27;email&#x27;
         };
      }
      else if(t == &quot;url&quot;) {
         return {
            &#x27;type&#x27;:&#x27;string&#x27;,
            &#x27;optional&#x27;: typeof ip.required == &quot;undefined&quot; ? true : !ip.required,
            &#x27;title&#x27;: ip.label,
            &#x27;format&#x27;:&#x27;url&#x27;
         };
      }
      else if(t == &quot;time&quot;) {
         return {
            &#x27;type&#x27;:&#x27;string&#x27;,
            &#x27;optional&#x27;: typeof ip.required == &quot;undefined&quot; ? true : !ip.required,
            &#x27;title&#x27;: ip.label,
            &#x27;format&#x27;:&#x27;time&#x27;
         };
      }
      else if(t == &quot;IPv4&quot;) {
         return {
            &#x27;type&#x27;:&#x27;string&#x27;,
            &#x27;optional&#x27;: typeof ip.required == &quot;undefined&quot; ? true : !ip.required,
            &#x27;title&#x27;: ip.label,
            &#x27;format&#x27;:&#x27;ip-address&#x27;
         };
      }
      else if(t == &quot;color&quot;) {
         return {
            &#x27;type&#x27;:&#x27;string&#x27;,
            &#x27;optional&#x27;: typeof ip.required == &quot;undefined&quot; ? true : !ip.required,
            &#x27;title&#x27;: ip.label,
            &#x27;format&#x27;:&#x27;color&#x27;
         };
      }
      else if(t == &quot;date&quot;) {
         return {
            &#x27;type&#x27;:&#x27;string&#x27;,
            &#x27;optional&#x27;: typeof ip.required == &quot;undefined&quot; ? true : !ip.required,
            &#x27;title&#x27;: ip.label,
            &#x27;format&#x27;:&#x27;date&#x27;
         };
      }
      else if(t == &quot;multiselect&quot; || t == &quot;multiautocomplete&quot;){
         return {
            &#x27;type&#x27;:&#x27;array&#x27;,
            &#x27;optional&#x27;: typeof ip.required == &quot;undefined&quot; ? true : !ip.required,
            &#x27;title&#x27;: ip.label,
            &#x27;items&#x27;: typeof ip.jsonSchemaRef == &quot;undefined&quot; ? {&quot;type&quot;:&quot;string&quot;}: ip.jsonSchemaRef,// it&#x27;s a little bit weird to mix a inputEx description field and jsonSchema in a specific attribute, we should had a $ref system to go through this properly
            &#x27;_inputex&#x27;: ip
         };
      }
      else {
         return {
            &#x27;type&#x27;: &#x27;string&#x27;,
            &#x27;title&#x27;: ip.label,
            &#x27;optional&#x27;: typeof ip.required == &quot;undefined&quot; ? true : !ip.required,
            &#x27;_inputex&#x27;: ip
         };
      }
      
   }

};


/**
 * @class inputEx.JsonSchema.Builder
 */
inputEx.JsonSchema.Builder = function(opts) {
   
   var options = opts || {};
   this.options  = options; 
   
   // specify how other schema properties are mapped to inputParam properties
   this.schemaToParamMap = options.schemaToParamMap || {
      &#x27;title&#x27;:&#x27;label&#x27;,
      &#x27;description&#x27;:&#x27;description&#x27;,
      &#x27;_inputex&#x27;:null // null value means copy child key/value pairs into field options directly
   };
   
   this.referenceResolver = options.referenceResolver || null;
   
   // options to be applied unless already specified
   this.defaultOptions = options.defaultOptions || {};
   
   // key is reference, value is schema
   this.schemaIdentifierMap = options.schemaIdentifierMap || {};
};

inputEx.JsonSchema.Builder.prototype = {
   
   /** 
    * return a schema based on the reference value default is to look up in map
    * @method defaultReferenceResolver
    */
   defaultReferenceResolver:function(reference) {
      return this.schemaIdentifierMap[reference] || null;
   },
   
   /**
    * Convert a JSON schema to inputEx JSON
    * @method schemaToInputEx
    * @param {JSONSchema} p
    */
   schemaToInputEx:function(p, propertyName) {
   
      var fieldDef = { label: propertyName, name: propertyName };
      var schemaMap = this.schemaToParamMap;
      var referencedSchema = p[&quot;$ref&quot;];
      var key;
       
      if(referencedSchema){
         var new_schema = null;
         if(this.referenceResolver) {
             new_schema = this.referenceResolver(referencedSchema);
          }
         if(new_schema === null) {
            new_schema = this.defaultReferenceResolver(referencedSchema);
         }
         if(new_schema === null) {
            throw new Error(&#x27;Schema for property : &quot;&#x27;+propertyName+&#x27;&quot; $references &quot;&#x27;+referencedSchema+&#x27;&quot;, not found&#x27;);
         }
         // copy options into new schema, for example we can overide presentation
         // of a defined schema depending on where it is used
         new_schema = Y.mix({},new_schema); // copy new_schema
         
         for(var pk in p) {
            if(p.hasOwnProperty(pk) &amp;&amp; lang.isUndefined(new_schema[pk]) &amp;&amp; pk != &#x27;$ref&#x27;) {
               new_schema[pk] = p[pk];
            }
         }
         p = new_schema;
      }

      if(!p.optional) {
         fieldDef.required = true;
      }

      for(key in schemaMap) {
         if(schemaMap.hasOwnProperty(key)) {
            var paramName = schemaMap[key],
                v = p[key];
            if(!lang.isUndefined(v)) {
               if(paramName === null) {
                  // copy / merge values from v directly into options
                  if(lang.isObject(v)) {
                     // v must be an object, copy key/value pairs into options
                     for(var vkey in v) {
                        if(v.hasOwnProperty(vkey)) {
                           fieldDef[vkey] = v[vkey];
                        }
                     }
                  }
               } else {
                  fieldDef[paramName] = v;
               }
            }
         }
      }
      if (!p.type) {
         p.type = &#x27;object&#x27;;
      }

      var type = p.type;
          
      // If type is a &quot;Union type definition&quot;, we&#x27;ll use the first type for the field
      // &quot;array&quot; &lt;=&gt;  [] &lt;=&gt; [&quot;any&quot;]
      if(lang.isArray(type)) {
         if(type.length === 0 || (type.length == 1 &amp;&amp; type[0] == &quot;any&quot;) ) {
            type = &quot;array&quot;;
         }
         else {
            type = type[0];
         }
      }
      //else if(lang.isObject(type) ) {
         // What do we do ??
         //console.log(&quot;type is an object !!&quot;);
      //}
      
      fieldDef.type = type;
      
      // default value
      if( !lang.isUndefined(p[&quot;default&quot;]) ) {
         fieldDef.value = p[&quot;default&quot;];
      }
   
      if(type == &quot;array&quot; ) {
         fieldDef.type = &quot;list&quot;;
         if(lang.isObject(p.items) &amp;&amp; !lang.isArray(p.items)) {
            // when items is an object, it&#x27;s a schema that describes each item in the list
            fieldDef.elementType = this.schemaToInputEx(p.items, propertyName);
         }

         if(p.minItems) { fieldDef.minItems = p.minItems; }
         if(p.maxItems) { fieldDef.maxItems = p.maxItems; }

      }
      else if(type == &quot;object&quot; ) {
         fieldDef.type = &quot;group&quot;;
         if(p.title &amp;&amp; lang.isUndefined(fieldDef.legend)) {
            fieldDef.legend = p.title; 
         }
         //fieldDef = this.schemaToInputEx(p, propertyName);
         //fieldDef = this._parseSchemaProperty(p, propertyName);
         var fields = [];
         if(propertyName) {
            fieldDef.name = propertyName;
         }

         for(key in p.properties) {
            if(p.properties.hasOwnProperty(key)) {
               fields.push( this.schemaToInputEx(p.properties[key], key) );
            }
         }

         fieldDef.fields = fields;
         
      }
      else if(type == &quot;string&quot; &amp;&amp; (p[&quot;enum&quot;] || p[&quot;choices&quot;]) ) {
         fieldDef.type = &quot;select&quot;;
         
         if(p.choices) {
            fieldDef.choices = [];
            for(var i = 0 ; i &lt; p.choices.length ; i++) {
               var o = p.choices[i];
               fieldDef.choices[i] = { label: o.label, value: o.value };
            }
         }
         else { // p.choices
            fieldDef.choices = [];
            for(var i = 0 ; i &lt; p[&quot;enum&quot;].length ; i++) {
               var o = p[&quot;enum&quot;][i];
               if(lang.isObject(o)) {
                  fieldDef.choices[i] = { label: o.label, value: o.value };
               }
               else {
                  fieldDef.choices[i] = { value: o };
               }
            }
         }
      }
      else if(type == &quot;string&quot;) {
         if(!lang.isUndefined(p.pattern) &amp;&amp; lang.isUndefined(fieldDef.regexp)) {
            if(lang.isString(p.pattern)) {
               fieldDef.regexp = new RegExp(p.pattern);
            } else {
               fieldDef.regexp = p.pattern;
            }
         }
         if(!lang.isUndefined(p.maxLength) &amp;&amp; lang.isUndefined(fieldDef.maxLength)) {
            fieldDef.maxLength = p.maxLength; 
         }
         if(!lang.isUndefined(p.minLength) &amp;&amp; lang.isUndefined(fieldDef.minLength)) {
            fieldDef.minLength = p.minLength; 
         }
         if(!lang.isUndefined(p.readonly) &amp;&amp; lang.isUndefined(fieldDef.readonly)) {
            fieldDef.readonly = p.readonly; 
         }

         // According to http://groups.google.com/group/json-schema/web/json-schema-possible-formats
         if( p.format ) {
            if(p.format == &quot;html&quot;) {
               fieldDef.type = &quot;html&quot;;
            } else if(p.format == &quot;date&quot;) {
               fieldDef.type = &quot;date&quot;;
               fieldDef.tooltipIcon = true;
            } else if(p.format == &#x27;url&#x27;) {
               fieldDef.type = &#x27;url&#x27;;
            } else if(p.format == &#x27;email&#x27;) {
               fieldDef.type = &#x27;email&#x27;;
            } else if(p.format == &#x27;text&#x27;) {
               fieldDef.type = &#x27;text&#x27;;
            } else if(p.format == &#x27;time&#x27;) {
               fieldDef.type = &#x27;time&#x27;;
            } else if(p.format == &#x27;ip-address&#x27;) {
               fieldDef.type = &#x27;IPv4&#x27;;
            } else if(p.format == &#x27;color&#x27;) {
               fieldDef.type = &#x27;color&#x27;;
            }
         }
      }
   
      // Override inputEx&#x27;s type with the &quot;_type&quot; attribute
      if (!!p[&quot;_inputex&quot;] &amp;&amp; !!p[&quot;_inputex&quot;][&quot;_type&quot;]) {
         fieldDef.type = p[&quot;_inputex&quot;][&quot;_type&quot;];
      }
   
      // Add the defaultOptions
      for (var kk in this.defaultOptions) {
         if (this.defaultOptions.hasOwnProperty(kk) &amp;&amp; lang.isUndefined(fieldDef[kk])) {
            fieldDef[kk] = this.defaultOptions[kk]; 
         }
      }

      return fieldDef;
   },

   /**
    * Create an inputEx Json form definition from a json schema instance object
    * Respect the &quot;Self-Defined Schema Convention&quot;
    * @method formFromInstance
    */
   formFromInstance: function(instanceObject) {
      if(!instanceObject || !instanceObject[&quot;$schema&quot;]) {
         throw new Error(&quot;Invalid json schema instance object. Object must have a &#x27;$schema&#x27; property.&quot;);
      }
      
      var formDef = this.schemaToInputEx(instanceObject[&quot;$schema&quot;]);
      
      // Set the default value of each property to the instance value
      for(var i = 0 ; i &lt; formDef.fields.length ; i++) {
         var fieldName = formDef.fields[i].name;
         formDef.fields[i].value = instanceObject[fieldName];
      }
      
      return formDef;
   }
   
};

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>

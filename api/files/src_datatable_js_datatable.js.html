<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/datatable/js/datatable.js - InputEx</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="InputEx" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 4.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/inputEx.html">inputEx</a></li>
                                <li><a href="../classes/inputEx.AutoComplete.html">inputEx.AutoComplete</a></li>
                                <li><a href="../classes/inputEx.Base.html">inputEx.Base</a></li>
                                <li><a href="../classes/inputEx.CheckBox.html">inputEx.CheckBox</a></li>
                                <li><a href="../classes/inputEx.CheckboxMultiState.html">inputEx.CheckboxMultiState</a></li>
                                <li><a href="../classes/inputEx.ColorField.html">inputEx.ColorField</a></li>
                                <li><a href="../classes/inputEx.CombineField.html">inputEx.CombineField</a></li>
                                <li><a href="../classes/inputEx.constructor.html">inputEx.constructor</a></li>
                                <li><a href="../classes/inputEx.DateField.html">inputEx.DateField</a></li>
                                <li><a href="../classes/inputEx.DatePickerField.html">inputEx.DatePickerField</a></li>
                                <li><a href="../classes/inputEx.DateSelectMonthField.html">inputEx.DateSelectMonthField</a></li>
                                <li><a href="../classes/inputEx.DateSplitField.html">inputEx.DateSplitField</a></li>
                                <li><a href="../classes/inputEx.DateTimeField.html">inputEx.DateTimeField</a></li>
                                <li><a href="../classes/inputEx.DDListField.html">inputEx.DDListField</a></li>
                                <li><a href="../classes/inputEx.DomainNameField.html">inputEx.DomainNameField</a></li>
                                <li><a href="../classes/inputEx.DSSelectField.html">inputEx.DSSelectField</a></li>
                                <li><a href="../classes/inputEx.EmailField.html">inputEx.EmailField</a></li>
                                <li><a href="../classes/inputEx.FileField.html">inputEx.FileField</a></li>
                                <li><a href="../classes/inputEx.Form.html">inputEx.Form</a></li>
                                <li><a href="../classes/inputEx.Group.html">inputEx.Group</a></li>
                                <li><a href="../classes/inputEx.HiddenField.html">inputEx.HiddenField</a></li>
                                <li><a href="../classes/inputEx.ImageCropperField.html">inputEx.ImageCropperField</a></li>
                                <li><a href="../classes/inputEx.InPlaceEdit.html">inputEx.InPlaceEdit</a></li>
                                <li><a href="../classes/inputEx.IntegerField.html">inputEx.IntegerField</a></li>
                                <li><a href="../classes/inputEx.IPv4Field.html">inputEx.IPv4Field</a></li>
                                <li><a href="../classes/inputEx.JsonSchema.html">inputEx.JsonSchema</a></li>
                                <li><a href="../classes/inputEx.JsonSchema.Builder.html">inputEx.JsonSchema.Builder</a></li>
                                <li><a href="../classes/inputEx.KeyOpValueField.html">inputEx.KeyOpValueField</a></li>
                                <li><a href="../classes/inputEx.KeyValueField.html">inputEx.KeyValueField</a></li>
                                <li><a href="../classes/inputEx.Lens.html">inputEx.Lens</a></li>
                                <li><a href="../classes/inputEx.LinkedComboField.html">inputEx.LinkedComboField</a></li>
                                <li><a href="../classes/inputEx.ListField.html">inputEx.ListField</a></li>
                                <li><a href="../classes/inputEx.MapField.html">inputEx.MapField</a></li>
                                <li><a href="../classes/inputEx.MenuField.html">inputEx.MenuField</a></li>
                                <li><a href="../classes/inputEx.mixin.html">inputEx.mixin</a></li>
                                <li><a href="../classes/inputEx.mixin.choice.html">inputEx.mixin.choice</a></li>
                                <li><a href="../classes/inputEx.MultiAutoComplete.html">inputEx.MultiAutoComplete</a></li>
                                <li><a href="../classes/inputEx.MultiSelectField.html">inputEx.MultiSelectField</a></li>
                                <li><a href="../classes/inputEx.NumberField.html">inputEx.NumberField</a></li>
                                <li><a href="../classes/inputEx.ObjectField.html">inputEx.ObjectField</a></li>
                                <li><a href="../classes/inputEx.Panel.html">inputEx.Panel</a></li>
                                <li><a href="../classes/inputEx.PasswordField.html">inputEx.PasswordField</a></li>
                                <li><a href="../classes/inputEx.PhoneField.html">inputEx.PhoneField</a></li>
                                <li><a href="../classes/inputEx.Plugin.InputExDataTable.html">inputEx.Plugin.InputExDataTable</a></li>
                                <li><a href="../classes/inputEx.RadioField.html">inputEx.RadioField</a></li>
                                <li><a href="../classes/inputEx.RatingStars.html">inputEx.RatingStars</a></li>
                                <li><a href="../classes/inputEx.RatingStarsForm.html">inputEx.RatingStarsForm</a></li>
                                <li><a href="../classes/inputEx.RPC.html">inputEx.RPC</a></li>
                                <li><a href="../classes/inputEx.RPC.Envelope.html">inputEx.RPC.Envelope</a></li>
                                <li><a href="../classes/inputEx.RPC.Envelope.JSON.html">inputEx.RPC.Envelope.JSON</a></li>
                                <li><a href="../classes/inputEx.RPC.Envelope.JSON-RPC-1.0.html">inputEx.RPC.Envelope.JSON-RPC-1.0</a></li>
                                <li><a href="../classes/inputEx.RPC.Envelope.JSON-RPC-2.0.html">inputEx.RPC.Envelope.JSON-RPC-2.0</a></li>
                                <li><a href="../classes/inputEx.RPC.Envelope.PATH.html">inputEx.RPC.Envelope.PATH</a></li>
                                <li><a href="../classes/inputEx.RPC.Envelope.URL.html">inputEx.RPC.Envelope.URL</a></li>
                                <li><a href="../classes/inputEx.RPC.Service.html">inputEx.RPC.Service</a></li>
                                <li><a href="../classes/inputEx.RPC.SMDTester.html">inputEx.RPC.SMDTester</a></li>
                                <li><a href="../classes/inputEx.RPC.Transport.html">inputEx.RPC.Transport</a></li>
                                <li><a href="../classes/inputEx.RTEField.html">inputEx.RTEField</a></li>
                                <li><a href="../classes/inputEx.SelectField.html">inputEx.SelectField</a></li>
                                <li><a href="../classes/inputEx.SerializeField.html">inputEx.SerializeField</a></li>
                                <li><a href="../classes/inputEx.SerializeField.serializers.html">inputEx.SerializeField.serializers</a></li>
                                <li><a href="../classes/inputEx.SerializeField.serializers.json.html">inputEx.SerializeField.serializers.json</a></li>
                                <li><a href="../classes/inputEx.SerializeField.serializers.xml.html">inputEx.SerializeField.serializers.xml</a></li>
                                <li><a href="../classes/inputEx.SliderField.html">inputEx.SliderField</a></li>
                                <li><a href="../classes/inputEx.StringAvailability.html">inputEx.StringAvailability</a></li>
                                <li><a href="../classes/inputEx.StringField.html">inputEx.StringField</a></li>
                                <li><a href="../classes/inputEx.Textarea.html">inputEx.Textarea</a></li>
                                <li><a href="../classes/inputEx.TextAutoTag.html">inputEx.TextAutoTag</a></li>
                                <li><a href="../classes/inputEx.TimeField.html">inputEx.TimeField</a></li>
                                <li><a href="../classes/inputEx.TimeIntervalField.html">inputEx.TimeIntervalField</a></li>
                                <li><a href="../classes/inputEx.TinyMCEField.html">inputEx.TinyMCEField</a></li>
                                <li><a href="../classes/inputEx.TreeField.html">inputEx.TreeField</a></li>
                                <li><a href="../classes/inputEx.TypeField.html">inputEx.TypeField</a></li>
                                <li><a href="../classes/inputEx.UneditableField.html">inputEx.UneditableField</a></li>
                                <li><a href="../classes/inputEx.UpperCaseField.html">inputEx.UpperCaseField</a></li>
                                <li><a href="../classes/inputEx.UrlField.html">inputEx.UrlField</a></li>
                                <li><a href="../classes/inputEx.VectorField.html">inputEx.VectorField</a></li>
                                <li><a href="../classes/inputEx.visus.html">inputEx.visus</a></li>
                                <li><a href="../classes/inputEx.widget.html">inputEx.widget</a></li>
                                <li><a href="../classes/inputEx.widget.Button.html">inputEx.widget.Button</a></li>
                                <li><a href="../classes/inputEx.widget.JsonTreeInspector.html">inputEx.widget.JsonTreeInspector</a></li>
                                <li><a href="../classes/Plugin.CalendarTodayHighlight.html">Plugin.CalendarTodayHighlight</a></li>
                                <li><a href="../classes/Plugin.CalendarWeekNumber.html">Plugin.CalendarWeekNumber</a></li>
                                <li><a href="../classes/Plugin.NodeMenuNavImproved.html">Plugin.NodeMenuNavImproved</a></li>
                                <li><a href="../classes/Y.InputexAccentRemover.html">Y.InputexAccentRemover</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/checkbox-multi-state.html">checkbox-multi-state</a></li>
                                <li><a href="../modules/inputex.html">inputex</a></li>
                                <li><a href="../modules/inputex-accent-remover
                
                As you may guess, this module will help you on the way you will handle your accent.
                There is a by instance configuration and you can easilly change it. see the example below
                
                ex:
                
                 var myAccentRemover1 = new Y.inputEx.AccentRemover(); __ check the default configuration for &#x27;e&#x27; below
                 var myAccentRemover2 = new Y.inputEx.AccentRemover();
                 myAccentRemover2.conf.e.regexp = _[èêẽēĕėëẻěȅȇẹȩęḙḛềếễểḕḗệḝǝɛ]_gi; __ we remove the é in the regexp
                
                 myAccentRemover1.removeAccents(&quot;treétreè&quot;); __ treetree
                 myAccentRemover2.removeAccents(&quot;treétreè&quot;); __ treétree.html">inputex-accent-remover
                
                As you may guess, this module will help you on the way you will handle your accent.
                There is a by instance configuration and you can easilly change it. see the example below
                
                ex:
                
                 var myAccentRemover1 = new Y.inputEx.AccentRemover(); // check the default configuration for &#x27;e&#x27; below
                 var myAccentRemover2 = new Y.inputEx.AccentRemover();
                 myAccentRemover2.conf.e.regexp = /[èêẽēĕėëẻěȅȇẹȩęḙḛềếễểḕḗệḝǝɛ]/gi; // we remove the é in the regexp
                
                 myAccentRemover1.removeAccents(&quot;treétreè&quot;); // treetree
                 myAccentRemover2.removeAccents(&quot;treétreè&quot;); // treétree</a></li>
                                <li><a href="../modules/inputex-autocomplete.html">inputex-autocomplete</a></li>
                                <li><a href="../modules/inputex-base.html">inputex-base</a></li>
                                <li><a href="../modules/inputex-button.html">inputex-button</a></li>
                                <li><a href="../modules/inputex-checkbox.html">inputex-checkbox</a></li>
                                <li><a href="../modules/inputex-choice.html">inputex-choice</a></li>
                                <li><a href="../modules/inputex-color.html">inputex-color</a></li>
                                <li><a href="../modules/inputex-combine.html">inputex-combine</a></li>
                                <li><a href="../modules/inputex-datatable.html">inputex-datatable</a></li>
                                <li><a href="../modules/inputex-date.html">inputex-date</a></li>
                                <li><a href="../modules/inputex-datepicker.html">inputex-datepicker</a></li>
                                <li><a href="../modules/inputex-dateselectmonth.html">inputex-dateselectmonth</a></li>
                                <li><a href="../modules/inputex-datesplit.html">inputex-datesplit</a></li>
                                <li><a href="../modules/inputex-datetime.html">inputex-datetime</a></li>
                                <li><a href="../modules/inputex-ddlist.html">inputex-ddlist</a></li>
                                <li><a href="../modules/inputex-dsselect.html">inputex-dsselect</a></li>
                                <li><a href="../modules/inputex-email.html">inputex-email</a></li>
                                <li><a href="../modules/inputex-field.html">inputex-field</a></li>
                                <li><a href="../modules/inputex-file.html">inputex-file</a></li>
                                <li><a href="../modules/inputex-form.html">inputex-form</a></li>
                                <li><a href="../modules/inputex-group.html">inputex-group</a></li>
                                <li><a href="../modules/inputex-hidden.html">inputex-hidden</a></li>
                                <li><a href="../modules/inputex-imagecropper.html">inputex-imagecropper</a></li>
                                <li><a href="../modules/inputex-inplaceedit.html">inputex-inplaceedit</a></li>
                                <li><a href="../modules/inputex-integer.html">inputex-integer</a></li>
                                <li><a href="../modules/inputex-ipv4.html">inputex-ipv4</a></li>
                                <li><a href="../modules/inputex-jsonschema.html">inputex-jsonschema</a></li>
                                <li><a href="../modules/inputex-jsontreeinspector.html">inputex-jsontreeinspector</a></li>
                                <li><a href="../modules/inputex-keyopvalue.html">inputex-keyopvalue</a></li>
                                <li><a href="../modules/inputex-keyvalue.html">inputex-keyvalue</a></li>
                                <li><a href="../modules/inputex-lens.html">inputex-lens</a></li>
                                <li><a href="../modules/inputex-linkedcombo.html">inputex-linkedcombo</a></li>
                                <li><a href="../modules/inputex-list.html">inputex-list</a></li>
                                <li><a href="../modules/inputex-map.html">inputex-map</a></li>
                                <li><a href="../modules/inputex-menu.html">inputex-menu</a></li>
                                <li><a href="../modules/inputex-multiautocomplete.html">inputex-multiautocomplete</a></li>
                                <li><a href="../modules/inputex-multiselect.html">inputex-multiselect</a></li>
                                <li><a href="../modules/inputex-number.html">inputex-number</a></li>
                                <li><a href="../modules/inputex-object.html">inputex-object</a></li>
                                <li><a href="../modules/inputex-panel.html">inputex-panel</a></li>
                                <li><a href="../modules/inputex-password.html">inputex-password</a></li>
                                <li><a href="../modules/inputex-phone.html">inputex-phone</a></li>
                                <li><a href="../modules/inputex-radio.html">inputex-radio</a></li>
                                <li><a href="../modules/inputex-ratingstars.html">inputex-ratingstars</a></li>
                                <li><a href="../modules/inputex-ratingstarsform.html">inputex-ratingstarsform</a></li>
                                <li><a href="../modules/inputex-rpc.html">inputex-rpc</a></li>
                                <li><a href="../modules/inputex-rte.html">inputex-rte</a></li>
                                <li><a href="../modules/inputex-select.html">inputex-select</a></li>
                                <li><a href="../modules/inputex-serialize.html">inputex-serialize</a></li>
                                <li><a href="../modules/inputex-slider.html">inputex-slider</a></li>
                                <li><a href="../modules/inputex-smdtester.html">inputex-smdtester</a></li>
                                <li><a href="../modules/inputex-string.html">inputex-string</a></li>
                                <li><a href="../modules/inputex-stringavailability.html">inputex-stringavailability</a></li>
                                <li><a href="../modules/inputex-textarea.html">inputex-textarea</a></li>
                                <li><a href="../modules/inputex-textautotag.html">inputex-textautotag</a></li>
                                <li><a href="../modules/inputex-time.html">inputex-time</a></li>
                                <li><a href="../modules/inputex-timeinterval.html">inputex-timeinterval</a></li>
                                <li><a href="../modules/inputex-timerange.html">inputex-timerange</a></li>
                                <li><a href="../modules/inputex-tinymce.html">inputex-tinymce</a></li>
                                <li><a href="../modules/inputex-tree.html">inputex-tree</a></li>
                                <li><a href="../modules/inputex-type.html">inputex-type</a></li>
                                <li><a href="../modules/inputex-uneditable.html">inputex-uneditable</a></li>
                                <li><a href="../modules/inputex-uppercase.html">inputex-uppercase</a></li>
                                <li><a href="../modules/inputex-url.html">inputex-url</a></li>
                                <li><a href="../modules/inputex-vector.html">inputex-vector</a></li>
                                <li><a href="../modules/inputex-visus.html">inputex-visus</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/datatable/js/datatable.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*global confirm:true*/

/**
 * The inputex-datatable module provides the inputEx.Plugin.InputExDataTable class which is a plugin.
 * @module inputex-datatable
 */

var inputEx = Y.inputEx;

Y.namespace(&#x27;inputEx.Plugin&#x27;);

/**
* Provide add/modify/delete functionalities on a dataTable as a plugin
* @class inputEx.Plugin.InputExDataTable
* @extends Plugin.Base
* @constructor
* @param {Object} configuration object
*/
inputEx.Plugin.InputExDataTable = function (config) {
   inputEx.Plugin.InputExDataTable.superclass.constructor.call(this, config);
};

inputEx.Plugin.InputExDataTable.NS = &quot;InputExDataTable&quot;;

Y.extend(inputEx.Plugin.InputExDataTable, Y.Plugin.Base, {
   
   /**
    * @method initializer
    */
   initializer: function () {

      var host = this.get(&quot;host&quot;);

      // enrich data (Model instance) with modify and delete attributs
      this.enrichData();
      
      // enrich DataTable with modify and delete columns
      this.enrichColumns();

      // add a button called &quot;add&quot; in order to add record in the DataTable
      if (host.get(&#x27;render&#x27;)) {
         this.addAddButton();
      }
      else {
         host.onceAfter(&#x27;render&#x27;, function () {
            this.addAddButton();
         }, this);
      }

      host.get(&quot;boundingBox&quot;).addClass(host.getClassName(&#x27;inputex&#x27;));
        
      if(!this.get(&quot;disableModifyFunc&quot;)) {
         // handle row modification
         host.delegate(&quot;click&quot;,this.modifyRecord, &quot;td.&quot;+host.getClassName(&#x27;cell-modify&#x27;), this);
      }

      if(!this.get(&quot;disableDeleteFunc&quot;)) {
         // handle row removal
         host.delegate(&quot;click&quot;,this.deleteRecord, &quot;td.&quot;+host.getClassName(&#x27;cell-delete&#x27;), this);
      }
      

      if(this.get(&quot;inplaceedit&quot;)) {
         host.get(&#x27;contentBox&#x27;).addClass( host.getClassName(&#x27;inplaceedit&#x27;) );
         this.setupInplaceEditing();
      }

    },


   setupInplaceEditing: function() {
      var host = this.get(&#x27;host&#x27;);

      // Delegate click event to make the inplace editor appear
      this.cellClickHandler = host.delegate(&quot;click&quot;, this.onCellClick, &quot;.&quot;+host.getClassName(&#x27;cell&#x27;), this);

      this.after(&#x27;editorShow&#x27;, this._onEditorShow, this);
   },

   _onEditorShow: function() {
      this.get(&#x27;inplaceOverlay&#x27;).show();
      this.docKeyListener = Y.one(&#x27;document&#x27;).once(&#x27;key&#x27;, Y.bind(this.onOverlayCancel, this), &#x27;esc&#x27;);
   },

   onCellClick: function(e) {

      var findTd = function(n) { return n.get(&#x27;tagName&#x27;) === &#x27;TD&#x27; &amp;&amp; n.hasClass(&#x27;yui3-datatable-cell&#x27;); },
          td = findTd(e.target) ? e.target : e.target.ancestor(findTd), // this might be a DIV because of a formatter (see color)
          host = this.get(&#x27;host&#x27;),
          colIndex = td.get(&#x27;parentNode&#x27;).get(&#x27;children&#x27;).indexOf(td),
          column = host.getColumn(colIndex),
          record = host.getRecord(td),
          key = column.key,
          value = record.get(key),

          overlay = this.get(&#x27;inplaceOverlay&#x27;),

          // inputEx Field config
          fieldConf = Y.Array.find(this.get(&#x27;inputEx&#x27;).fields, function(i) { return i.name === key; }),
          conf = Y.mix({
            parentEl: this.overlayFieldContainer.getDOMNode()
          }, fieldConf),
          field;

      // When we changed the value of an overlay but click on another cell, it doesn&#x27;t save automatically
      // since the event is stopped. So we do it manually here.
      // TODO: this can have strange effects if you&#x27;re editing to fast because of the this._inplaceeditCell collision
      if( overlay.get(&#x27;visible&#x27;) &amp;&amp; !overlay.get(&#x27;boundingBox&#x27;).contains(e.target) ) {
         this.onOverlaySave();
      }

      if( !fieldConf ||
          fieldConf.type === &quot;uneditable&quot; ||
          td.hasClass(&#x27;yui3-datatable-cell-delete&#x27;) ||
          td.hasClass(&#x27;yui3-datatable-cell-modify&#x27;) ) {
         return;
      }

      e.stopPropagation();

      // Align
      overlay.align(td, [&quot;tl&quot;, &quot;tl&quot;]);

      // Render field
      this.overlayFieldContainer.set(&#x27;innerHTML&#x27;, &#x27;&#x27;);
      field = new Y.inputEx(conf);
      field.setValue(value);
      
      // Timeout to make the focus work on inplaceEdit
      setTimeout(function(){
         field.focus();
      }, 20);

      this._inplaceeditCell = {
         record: record,
         key: column.key,
         field: field,
         td: td
      };

      // TODO: fire an event editorShow
      this.fire(&#x27;editorShow&#x27;, {
         column: column,
         record: record,
         key: key,
         value: value,
         cell: td,
         field: field
      });

   },


   _initInplaceOverlay: function() {

      var o = new Y.Overlay({
            zIndex: 5
          }),
          contentBox = o.get(&#x27;contentBox&#x27;),
          overlayFieldContainer = Y.Node.create(&quot;&lt;div /&gt;&quot;),
          overlayButtonsContainer = Y.Node.create(&quot;&lt;div class=&#x27;editor-buttons&#x27; /&gt;&quot;),
          saveButton,
          cancelButton;

      contentBox.appendChild(overlayFieldContainer);
      this.overlayFieldContainer = overlayFieldContainer;

      contentBox.appendChild(overlayButtonsContainer);

      // Overlay save and cancel buttons
      saveButton = Y.Node.create(&#x27;&lt;button&gt;&#x27;+this.get(&quot;strings&quot;).saveText+&#x27;&lt;/button&gt;&#x27;);
      overlayButtonsContainer.appendChild(saveButton);

      saveButton.addClass(&#x27;yui3-button&#x27;);
      saveButton.addClass(&#x27;yui3-button-primary&#x27;);

      cancelButton = Y.Node.create(&#x27;&lt;button&gt;&#x27;+this.get(&quot;strings&quot;).cancelText+&#x27;&lt;/button&gt;&#x27;);

      cancelButton.addClass(&#x27;yui3-button&#x27;);
      cancelButton.addClass(&#x27;yui3-button-link&#x27;);


      overlayButtonsContainer.appendChild(cancelButton);
      saveButton.on(&#x27;mousedown&#x27;, this.onOverlaySave, this);
      cancelButton.on(&#x27;mousedown&#x27;, this.onOverlayCancel, this);

      // Close overlay if click outside of the overlay
      this.docClickHandler = Y.on(&#x27;click&#x27;, Y.bind(function(e) {
         var overlay = this.get(&#x27;inplaceOverlay&#x27;);

         if( overlay.get(&#x27;visible&#x27;) &amp;&amp; !overlay.get(&#x27;boundingBox&#x27;).contains(e.target) ) {
            this.onOverlaySave();
         }
      }, this), Y.config.doc);

      contentBox.addClass(this.get(&#x27;host&#x27;).getClassName(&#x27;inplaceOverlay&#x27;));

      o.hide();
      o.render();
      return o;
   },

   onOverlaySave: function() {

      // Call the updateMethod async method
      var updateMethod = this.get(&#x27;updateMethod&#x27;),
          field = this._inplaceeditCell.field,
          newValue = field.getValue(),
          record = this._inplaceeditCell.record,
          key = this._inplaceeditCell.key,
          oldValue = record.get(key),
          fieldValues = {},
          id = record.get(&#x27;id&#x27;),
          host = this.get(&#x27;host&#x27;),
          td = this._inplaceeditCell.td;

      if(!field.validate()) {
         return;
      }

      // has not changed =&gt; don&#x27;t do anything
      if ((Y.Lang.isDate(newValue) &amp;&amp; Y.Lang.isDate(oldValue) &amp;&amp; newValue.getTime() === oldValue.getTime()) ||
          (newValue === oldValue)) {
         this.onOverlayCancel();
         return;
      }

      fieldValues[key] = newValue;

      this._addEditedClass(td);

      updateMethod.call(this, id, fieldValues, Y.bind(function(success) {
         if (success) {
            // on success, update the record in the datatable
            host.get(&quot;data&quot;).getById(id).setAttrs(fieldValues);
         }
         this._removeEditedClass(td, success);
      },this));

      this.onOverlayCancel();
   },

   onOverlayCancel: function() {
      this.get(&#x27;inplaceOverlay&#x27;).hide();
      this.docKeyListener.detach();
   },

   /**
    * add Attributes on the data model depending on the plugin configuration
    *
    * @method enrichData
    */
   enrichData: function () {

      var that = this,
          data = this.get(&quot;host&quot;).get(&quot;data&quot;);

      data.each(function (model) {
         if(!this.get(&quot;disableModifyFunc&quot;)) {
            that.addModifyAttr(model);
         }
         if(!this.get(&quot;disableDeleteFunc&quot;)){
            that.addDeleteAttr(model);
         }
      });

   },

   /**
    * add Columns on the DataTable depending on the plugin configuration
    *
    * @method enrichColumns
    */
   enrichColumns: function () {

      if(!this.get(&quot;disableModifyFunc&quot;)) {
         this.addModifyColumn();
      }
      
      if(!this.get(&quot;disableDeleteFunc&quot;)) {
         this.addDeleteColumn();
      }
   },

   /**
    * Provide the add button in order to add record on the DataTable
    *
    * @method addAddButton
    */
   addAddButton: function() {

      if(!this.get(&quot;disableAddFunc&quot;)) {
      
         var buttonHtml = &quot;&lt;button class=&#x27;yui3-button&#x27;&gt;&quot;+this.get(&quot;strings&quot;).addButtonText+&quot;&lt;/button&gt;&quot;,
             host = this.get(&quot;host&quot;);

         this.addButtonTop    = Y.Node.create(buttonHtml);
         this.addButtonBottom = Y.Node.create(buttonHtml);

         this.addButtonTop.addClass(host.getClassName(&#x27;add-button-top&#x27;));
         this.addButtonBottom.addClass(host.getClassName(&#x27;add-button-bottom&#x27;));

         this.get(&quot;host&quot;).get(&quot;contentBox&quot;).prepend(this.addButtonTop);
         this.get(&quot;host&quot;).get(&quot;contentBox&quot;).append(this.addButtonBottom);
         
         this.addButtonTop.on(&quot;click&quot;,    this._onAddButtonClick, this);
         this.addButtonBottom.on(&quot;click&quot;, this._onAddButtonClick, this);
      }
   
   },

   _onAddButtonClick: function (e) {
      var panel = this.get(&quot;panel&quot;);

      e.stopPropagation();

      panel.set(&quot;headerContent&quot;,this.get(&quot;strings&quot;).addItemHeader);
      panel.get(&quot;field&quot;).clear();
      panel.show();
   },

   /**
    *
    * @method modifyRecord
    */
   modifyRecord: function(e) {
      
      e.halt();
      
      var record = this.get(&quot;host&quot;).getRecord(e.currentTarget),
          panel = this.get(&quot;panel&quot;);

      panel.set(&quot;headerContent&quot;,this.get(&quot;strings&quot;).modifyItemHeader);
      panel.get(&#x27;field&#x27;).setValue(record.getAttrs());
      panel.show();
   },

   /**
    * Called when the user clicked on a link to delete a record
    * @method deleteRecord
    */
   deleteRecord: function(e) {
      
      e.halt();

      var deleteMethod,
          host = this.get(&#x27;host&#x27;),
          record = host.getRecord(e.currentTarget);

      if (!this.get(&quot;confirmDelete&quot;) || confirm(this.get(&quot;strings&quot;).confirmDeletion)) {

         // Call the deleteMethod async method
         deleteMethod = this.get(&#x27;deleteMethod&#x27;);

         this._addEditedClass(record);

         deleteMethod.call(this, record, Y.bind(function(success) {
            if (success) {
               // on success, remove the record from the datatable
               host.get(&quot;data&quot;).remove(record);
            }
            this._removeEditedClass(record, success);
         },this));

      }
   },

   /**
    *
    * @method deleteExtraColumns
    */
   deleteExtraColumns: function() {
      
      if(!this.get(&quot;disableModifyFunc&quot;)) {
         this.removeModifyColumn();
      }
      if(!this.get(&quot;disableDeleteFunc&quot;)) {
         this.removeDeleteColumn();
      }
   },

   /**
    *
    * @method _initPanel
    * @private
    */
   _initPanel: function () {

      var opts = Y.mix({}, this.get(&#x27;panelOptions&#x27;) ), panel;

      panel = new Y.inputEx.Panel( Y.mix(opts, {
         inputEx: this.get(&quot;inputEx&quot;),
         buttons: {
            header: [&#x27;close&#x27;],

            footer: [
               {  
                  name: &#x27;panelSave&#x27;,
                  value: this.get(&quot;strings&quot;).saveText,
                  action: Y.bind(this.onPanelSaveButton, this),
                  classNames: &#x27;yui3-button-primary&#x27;
               },
               {  
                  name: &#x27;panelCancel&#x27;,
                  value: this.get(&quot;strings&quot;).cancelText,
                  action: Y.bind(this.onPanelCancelButton, this),
                  classNames: &#x27;yui3-button-link&#x27;
               }
            ]
         }
      }) );

      // first the panel needs to be &quot;render&quot; then &quot;show&quot;
      panel.render();
      return panel;
   },

   onPanelCancelButton: function (e) {
      e.preventDefault();
      this.get(&#x27;panel&#x27;).hide();
   },

   onPanelSaveButton: function (e) {
      e.preventDefault();

      var field = this.get(&quot;panel&quot;).get(&quot;field&quot;),
         fieldValues = field.getValue(),
         host = this.get(&quot;host&quot;),
         record,
         RecordType,
         updateMethod,
         addMethod;
      
      if (!field.validate()) {
         return;
      }
      
      // Disable save button
      this.disableSaveButton(true);
      
      // Modification
      if (fieldValues.id) {

         // Call the updateMethod async method
         updateMethod = this.get(&#x27;updateMethod&#x27;);

         record = host.get(&quot;data&quot;).getById(fieldValues.id);
         this._addEditedClass(record);

         updateMethod.call(this, fieldValues.id, fieldValues, Y.bind(function(success) {
            if (success) {
               
               // on success, update the record in the datatable
               host.get(&quot;data&quot;).getById(fieldValues.id).setAttrs(fieldValues);
               this.get(&#x27;panel&#x27;).hide();
            }
            
            // Enable save button
            this.disableSaveButton(false);
            
            this._removeEditedClass(record, success);
            
         },this));

      }
      // Creation
      else {

         fieldValues.id = this.generateId(this.get(&quot;idSize&quot;));
         RecordType = host.get(&quot;recordType&quot;);
         record = new RecordType();
         record.setAttrs(fieldValues);
         this.addModifyAttr(record);
         this.addDeleteAttr(record);

         // call the async method to create a record
         addMethod = this.get(&#x27;addMethod&#x27;);
         addMethod.call(this, record, Y.bind(function(success) {
            if (success) {
               
               // if success, add the record in the datatable
               host.get(&quot;data&quot;).add(record);
               this.get(&#x27;panel&#x27;).hide();
            }
            
            // Enable save button
            this.disableSaveButton(false);
            
         },this));

      }

   },
   
   disableSaveButton : function(bool) {
      var button = this.get(&#x27;panel&#x27;).getButton(&#x27;panelSave&#x27;);
      button.set(&#x27;disabled&#x27;, bool);
   },
   
   /**
    *
    * @method destructor
    */
   destructor: function() {

      var that = this,
          host = this.get(&#x27;host&#x27;),
          data = host.get(&quot;data&quot;);

      data.each(function (model) {

         if(!this.get(&quot;disableModifyFunc&quot;)) {
            that.delModifyAttr(model);
         }
         if(!this.get(&quot;disableDeleteFunc&quot;)) {
            that.delDeleteAttr(model);
         }

      });
      
      this.deleteExtraColumns();
      
      if(!this.get(&quot;disableAddFunc&quot;)) {
         this.addButtonTop.remove();
         this.addButtonBottom.remove();
      }

      if(this.get(&quot;inplaceedit&quot;)) {
         host.get(&#x27;contentBox&#x27;).removeClass( host.getClassName(&#x27;inplaceedit&#x27;) );
         this.cellClickHandler.detach();

         if (this.docClickHandler) {
            this.docClickHandler.detach();
         }
      }

      this.get(&quot;panel&quot;).destroy();
   },


   /**
    * Add the modify attribute on the data model
    *
    * @method addModifyAttr
    */
   addModifyAttr: function(model) {
      model.addAttr(&quot;modify&quot;);
   },

   /**
    * Add the delete attribute on the data model
    *
    * @method addDeleteAttr
    */
   addDeleteAttr: function (model) {
      model.addAttr(&quot;delete&quot;);
   },

   /**
    * Remove the modify attribute from the data model
    *
    * @method delModifyAttr
    */
   delModifyAttr: function(model) {
      model.removeAttr(&quot;modify&quot;);
   },

   /**
    * Remove the modify attribute from the data model
    *
    * @method delDeleteAttr
    */
   delDeleteAttr: function (model) {
      model.removeAttr(&quot;delete&quot;);
   },

   /**
    * Add the modify column on the DataTable
    *
    * @method addModifyColumn
    */
   addModifyColumn: function() {

      var host = this.get(&#x27;host&#x27;);
         
      host.addColumn({
         label: &#x27; &#x27;,
         key: this.get(&quot;strings&quot;).modifyText,
         className: host.getClassName(&#x27;cell-modify&#x27;),
         formatter: this.get(&#x27;modifyColumnFormatter&#x27;),
         nodeFormatter: this.get(&#x27;modifyColumnNodeFormatter&#x27;)
      });

   },
   
   /**
    * Add the delete column on the DataTable
    *
    * @method addDeleteColumn
    */
   addDeleteColumn: function() {
      
      var host = this.get(&#x27;host&#x27;);
         
      host.addColumn({
         label: &#x27; &#x27;,
         key: this.get(&quot;strings&quot;).deleteText,
         className: host.getClassName(&#x27;cell-delete&#x27;),
         formatter: this.get(&#x27;deleteColumnFormatter&#x27;),
         nodeFormatter: this.get(&#x27;deleteColumnNodeFormatter&#x27;)
      });
   },

   /**
    * Remove the modify column from the DataTable
    *
    * @method removeModifyColumn
    */
   removeModifyColumn: function() {
      this.get(&quot;host&quot;).removeColumn(&quot;modify&quot;);
   },

   /**
    * Remove the delete column from the DataTable
    *
    * @method removeDeleteColumn
    */
   removeDeleteColumn: function() {
      this.get(&quot;host&quot;).removeColumn(&quot;delete&quot;);
   },


   generateId : function(size) {
      var prefixId = this.get(&quot;prefixId&quot;),
          s = size ? size : 5;
      prefixId = prefixId ? prefixId : &quot;&quot;;
      return prefixId + Math.floor(Math.random()*Math.pow(10,s));
   },

   _addEditedClass: function (record) {
      var host = this.get(&#x27;host&#x27;);
      if (record instanceof Y.Node) {
         record.addClass(host.getClassName(&#x27;cell-edited&#x27;));
      }
      else {
         host.getRow(record).addClass(host.getClassName(&#x27;row-edited&#x27;));
      }
   },

   _removeEditedClass: function (record, now) {
      Y.later(now === true ? 0 : (Y.Lang.isNumber(now) ? now : 5000), this, function () {
         var host = this.get(&#x27;host&#x27;), row;
         if (record instanceof Y.Node) {
            record.removeClass(host.getClassName(&#x27;cell-edited&#x27;));
         }
         else {
            row = host.getRow(record);
            if (row) {
               row.removeClass(host.getClassName(&#x27;row-edited&#x27;));
            }
         }
      });
   },
   
   _initStrings : function() {
      return Y.Intl.get(&quot;inputex-datatable&quot;);
   }

}, {

/**
 * Static property used to define the default attribute configuration of
 * the Plugin.
 *
 * @property ATTRS
 * @type {Object}
 * @static
 */
ATTRS: {

   /**
    * This is an inputEx field definition. This is used when a user try to create/modify a record
    *
    * @attribute inputEx
    */
   inputEx: {},


   /**
    * This string is inserted before the generated id
    *
    * @attribute prefixId
    * @type String
    * @example prefixId : &quot;po-&quot; --&gt; id = po-1342561
    */
   prefixId: {
     value: &quot;&quot;
   },

   /**
    * This represents the number of digits used in the id generation
    *
    * @attribute idSize
    * @type Number
    */
   idSize: {
     value: 5
   },

   /**
    * If true the add functionality is disabled
    *
    * @attribute disableAddFunc
    * @type boolean
    */
   disableAddFunc: {
     value: false
   },

   /**
    * If true the modify functionality is disabled
    * @attribute disableModifyFunc
    * @type boolean
    */
   disableModifyFunc: {
     value: false
   },

   /**
    * If true the delete functionality is disabled
    *
    * @attribute disableDeleteFunc
    * @type boolean
    */
   disableDeleteFunc: {
     value: false
   },

   /**
    * Labels of the plugin
    *
    * @attribute modifyColumnLabel
    */
   strings : {
     value : null,
     valueFn : &#x27;_initStrings&#x27;
   },

   /**
    * If true a confirmation will be asked to the user when a delete attempt appear
    *
    * @attribute confirmDelete
    * @type boolean
    */
   confirmDelete: {
     value: true
   },

   /**
    * This panel will be displayed on record creation/modication
    * @attribute panel
    * @type Y.inputEx.Panel
    */
   panel: {
     valueFn: &#x27;_initPanel&#x27;,
     lazyAdd: true
   },

   panelOptions: {
      value: {
         centered: true,
         width: 500,
         modal: true,
         zIndex: 5,
         visible: false
      }
   },

   /**
    * Set to true if you want to activate in-cell editing (ALPHA)
    * @attribute inplaceedit
    * @type boolean
    */
   inplaceedit: {
      value: false
   },

   /**
    * Overlay used for the inplace editing
    * @attribute inplaceOverlay
    * @type Y.Overlay
    */
   inplaceOverlay: {
     valueFn: &#x27;_initInplaceOverlay&#x27;,
     lazyAdd: true
   },

   /**
    * Function used to confirm the creation of a new record.
    * You can perform validation and/or ajax creation.
    * addMethod must be a function(record, cb) which calls &#x27;cb&#x27; with success status as first argument
    * @attribute addMethod
    * @type function
    */
   addMethod: {
      value: function(record, cb) {
         cb(true);
      }
   },

   /**
    * Function used to confirm the modification of an existing record.
    * You can perform validation and/or ajax update.
    * updateMethod must be a function(id, newValues, cb) which calls &#x27;cb&#x27; with success status as first argument
    * @attribute updateMethod
    * @type function
    */
   updateMethod: {
      value: function(id, newValues, cb) {
         cb(true);
      }
   },

   /**
    * Function used to confirm the deletion of an existing record.
    * You can perform validation and/or ajax deletion.
    * deleteMethod must be a function(record, cb) which calls &#x27;cb&#x27; with success status as first argument
    * @attribute deleteMethod
    * @type function
    */
   deleteMethod: {
      value: function(record, cb) {
         cb(true);
      }
   },

   /**
    * Formatter for the modify column
    * @attribute modifyColumnFormatter
    * @type function
    */
   modifyColumnFormatter: {
      value: null
   },

   /**
    * Formatter for the delete column
    * @attribute deleteColumnFormatter
    * @type function
    */
   deleteColumnFormatter: {
      value: null
   },

   /**
    * nodeFormatter for the modify column
    * @attribute modifyColumnNodeFormatter
    * @type function
    */
   modifyColumnNodeFormatter: {
      value: null
   },

   /**
    * nodeFormatter for the delete column
    * @attribute deleteColumnNodeFormatter
    * @type function
    */
   deleteColumnNodeFormatter: {
      value: null
   }

}

});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
